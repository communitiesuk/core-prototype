{% extends "schemes/_scheme-layout.njk" %}

{% set section = "locations" %}

{% block sectionContent %}
  {{ govukButton({
    classes: "govuk-button--secondary",
    text: "Add another location" if locationsCount > 1 else "Add a location",
    href: schemePath + "/location/new"
  }) if not scheme.deactivated }}

  {% for itemId, location in scheme.locations %}
    {#-
      Data coordinators can edit locations
      Admins can edit and delete locations
    -#}
    {{ xGovukSummaryCard({
      titleText: location.address or location.postcode,
      actions: actionLinks(
        [{
          href: schemePath + "/location/" + itemId,
          text: "Edit",
          visuallyHiddenText: location.address or location.postcode
        }, {
          href: schemePath + "/location/" + itemId + "/delete",
          text: "Delete",
          visuallyHiddenText: location.address or location.postcode
        }] if isAdmin else [{
          href: schemePath + "/location/" + itemId,
          text: "Edit",
          visuallyHiddenText: location.address or location.postcode
        }]
      ) if not scheme.deactivated,
      classes: "govuk-!-margin-bottom-6",
      rows: [{
        key: {
          text: "Location code"
        },
        value: {
          classes: "app-!-font-tabular",
          text: "S" + scheme.id + "-" + location.postcode | replace(" ", "")
        }
      }, {
        key: {
          text: "Postcode"
        },
        value: {
          text: macro.postcodeHtml(location.postcode, location["local-authority"].name) if location.postcode else "Not known"
        }
      }, {
        key: {
          text: "Type of unit"
        },
        value: {
          text: location["type-of-unit"] | textFromInputValue(data.questions["type-of-unit"].supported)
        }
      }, {
        key: {
          text: "Type of building"
        },
        value: {
          text: location["type-of-building"] | textFromInputValue(data.questions["type-of-building"])
        }
      }, {
        key: {
          text: "Wheelchair adaptation"
        },
        value: {
          text: location["is-adapted"] | textFromInputValue(data.questions["yes-no"])
        }
      }]
    }) }}
  {% endfor %}
{% endblock %}
